const bancoPerguntas = {
    iniciante: [
        {
            pergunta: "Quem não está entre os 10 prometidos ao Paraíso?",
            opcoes: ["Tal'ha (R.A)", "Zubeyr (R.A)", "Abu Obayda (R.A)", "Abu Jahal"],
            correta: 3,
            explicacao: "Abu Jahal foi o maior inimigo do Islã em Meca. O Profeta (S.A.W) disse dele: Ele é o Faraó da minha comunidade"
        },
        {
            pergunta: "Após minha conversão, os muçulmanos puderam realizar orações abertamente perto da Caaba. Quem sou eu?",
            opcoes: ["Abu Bakr", "Hamza", "Omar", "Abu Sofian"],
            correta: 2,
            explicacao: "Omar (R.A) era um líder respeitado, e sua conversão fortaleceu significativamente a comunidade muçulmana em Meca."
        },
        {
            pergunta: "Qual companheiro do Profeta ﷺ dormiu na cama do Profeta ﷺ na noite da Hégira para enganar os coraixitas?",
            opcoes: ["Ali", "Omar", "Otman", "Abu Bakr"],
            correta: 0,
            explicacao: "O Mensageiro de Allah (S.A.W) pediu a Ali que dormisse em sua cama e se cobrisse com seu manto para enganar os coraixitas."
        },
        {
            pergunta: "Qual companheiro disse: \"Por que adoramos essas pedras que nada nos trazem?\"",
            opcoes: ["Abu Bakr Omar (R.A)", "Omar (R.A)", "Otman (R.A)", "Ali (R.A)"],
            correta: 1,
            explicacao: "Omar disse: 'Por que adoramos essas pedras que nada nos trazem?' (Sahih Muslim, 2398)"
        },
        {
            pergunta: "Qual companheiro foi o primeiro muazin do Islã?",
            opcoes: ["Bilal", "Ibn Mas'ud", "Zubayr", "Tal'ha"],
            correta: 0,
            explicacao: "O Profeta (S.A.W) disse a Bilal: \"Recite o Adhan, pois você tem uma voz forte e agradável.\" (Sahih Muslim, 384)"
        },
        {
            pergunta: "Quem foi Hamza, o Leão de Alá, para o Profeta ﷺ?",
            opcoes: ["Seu irmão", "Seu primo", "Seu sobrinho", "Seu tio"],
            correta: 3,
            explicacao: "Hamza ibn Abdul-Muttalib era tio do Profeta (S.A.W) e conhecido como o Leão de Alá."
        },
        {
            pergunta: "Quem era o companheiro que veio da Pérsia?",
            opcoes: ["Outro companheiro", "ObeYDa", "Salman", "Tal'ha"],
            correta: 2,
            explicacao: "Salman el Farisi (o Persa) tem uma longa e extraordinária história em sua busca pela verdadeira religião."
        },
        {
            pergunta: "Hafsa é filha de...?",
            opcoes: ["Abu Bakr", "Omar", "Ali", "Otman"],
            correta: 1,
            explicacao: "Hafsa era filha de Omar (R.A) e foi uma das esposas do Profeta (S.A.W). Sua irmã Aisha era filha de Abu Bakr."
        },
        {
            pergunta: "Minha filha Hafsa foi uma das esposas do Profeta ﷺ. Quem sou eu?",
            opcoes: ["Abu Bakr", "Omar", "Ali", "Otman"],
            correta: 1,
            explicacao: "Omar (R.A) foi pai de Hafsa, que se tornou esposa do Profeta (S.A.W)."
        },
        {
            pergunta: "Qual companheiro era conhecido por sua gentileza e humildade a ponto de o Profeta ﷺ lhe dar o apelido de \"o homem gentil desta comunidade\"?",
            opcoes: ["Abu Bakr", "Omar", "Otman", "Ali"],
            correta: 2,
            explicacao: "Uthman é um homem gentil e modesto; até os anjos são modestos para com ele. (Sahih Muslim, 2401)"
        },
        {
            pergunta: "Quem foi o primeiro califa do Islã guiado corretamente?",
            opcoes: ["Abu Bakr", "Omar", "Otman", "Ali"],
            correta: 0,
            explicacao: "Seu califado durou 2 anos, 3 meses e 9 dias. Abu Bakr faleceu aos 63 anos no dia 17 de Jamadil Akhar, 17 anos após a Hégira."
        },
        {
            pergunta: "Os netos do Profeta ﷺ, filhos de Ali e Fátima ﷺ, são",
            opcoes: ["Maomé e Mahmoud", "Hassan e Mohsin", "Al Hassan e Al Hussein", "Khalid e Khowaylid"],
            correta: 2,
            explicacao: "Referidos em um hadith profético como: Os dois belos jovens do Paraíso (Shababay Ahl al-Jannah)"
        },
        {
            pergunta: "Quem é Ali, o 4º califa bem guiado em relação ao Profeta ﷺ?",
            opcoes: ["Seu tio", "Seu primo", "Seu irmão", "Seu sobrinho"],
            correta: 1,
            explicacao: "Ali era primo do Profeta (S.A.W) e também genro, tendo se casado com sua filha Fátima (R.A)."
        },
        {
            pergunta: "Qual companheiro recebeu o apelido de \"O Leão de Alá\" e morreu como mártir na Batalha de Uhud?",
            opcoes: ["Tal'a", "Zubayr", "Hamza", "Al Hussein"],
            correta: 2,
            explicacao: "O Profeta (S.A.W) disse, enquanto chorava por Hamza: \"O Senhor dos mártires é Hamza ibn Abdul-Muttalib.\" (Sahih Ibn Majah, 1450)"
        },
        {
            pergunta: "Qual companheiro foi sepultado com as roupas ensanguentadas após ser martirizado na Batalha de Uhud?",
            opcoes: ["Hamza", "Abu Hurayra", "Tal'ha", "Zubayr"],
            correta: 0,
            explicacao: "O Profeta (S.A.W) ordenou que Hamza fosse enterrado com suas roupas, sem lavá-las. (Sahih Al-Bukhari, 4072)"
        },
        {
            pergunta: "Quem foi o segundo califa do Islã guiado corretamente?",
            opcoes: ["Abu Bakr", "Omar", "Otman", "Ali"],
            correta: 1,
            explicacao: "Seu califado durou 10 anos, 6 meses e 5 dias e faleceu no dia de Muharram no ano 24 depois de Hijra."
        },
        {
            pergunta: "A ordem dos Califas Bem-Guiados é Abu Bakr, Umar, Ali e Uthman?",
            opcoes: ["Verdadeiro", "Falso"],
            correta: 1,
            explicacao: "Esses são Abu Bakr, Omar, Othman e Ali. A ordem correta é Abu Bakr, Omar, Othman e Ali."
        },
        {
            pergunta: "A primeira pessoa a acreditar no Islã foi uma mulher?",
            opcoes: ["Verdadeiro", "Falso"],
            correta: 0,
            explicacao: "Era Khadija (R.A), que Allah esteja satisfeito com ela, esposa do Profeta (S.A.W)."
        },
        {
            pergunta: "Quem era o primo do Profeta ﷺ?",
            opcoes: ["Abdullah Ibn Omar", "Abdallah Ibn Mas'oud", "Abdallah Ibn Ommi Maktum", "Abdullah Ibn Abbas"],
            correta: 3,
            explicacao: "Seu pai, Al Abbas, era tio do Profeta (S.A.W). Ibn Abbas foi o primeiro exegeta do Alcorão, atendendo à súplica do Profeta."
        },
        {
            pergunta: "Sou primo do Profeta ﷺ e o primeiro filho a se converter ao Islã, quem sou eu?",
            opcoes: ["Zayd Ibn Haritha", "Anas Ibn Mali", "Ali Ibn Abu Talib", "Abdullah Ibn Abbas"],
            correta: 2,
            explicacao: "Ali Ibn Abu Talib foi primo do Profeta (S.A.W) e o primeiro filho a abraçar o Islã."
        }
    ],
    intermediario: [
        {
            pergunta: "Quem o Profeta (S.A.W) designou para liderar a oração no final de sua vida?",
            opcoes: ["Abu Bakr", "Omar", "Ali", "Otman"],
            correta: 0,
            explicacao: "Abu Bakr foi designado para liderar as orações, o que indicava sua posição de liderança futura."
        },
        {
            pergunta: "Qual companheiro recebeu o apelido de \"O servo do Mensageiro de Alá\"?",
            opcoes: ["Abu Hurayra", "Anas ibn Malik", "Ibn Mas'ud", "Ibn Abbas"],
            correta: 1,
            explicacao: "Anas ibn Malik disse: \"Eu servi ao Profeta ﷺ por dez anos, e ele nunca me disse uma vez: 'Por que você fez isso?'\" (Sahih Muslim, 2309)"
        },
        {
            pergunta: "Qual companheiro lutou ao lado do Profeta ﷺ usando um turbante vermelho na Batalha de Badr e era conhecido por sua bravura?",
            opcoes: ["Ali", "Zubayr (R.A)", "Hamza", "Tal'ha"],
            correta: 1,
            explicacao: "Zubayr usava um turbante vermelho e lutou bravamente em Badr. (Sahih Muslim, 2416)"
        },
        {
            pergunta: "Qual companheiro lutou a vida inteira por Alá, mas morreu em sua cama?",
            opcoes: ["Al-Miqdad", "Khalid ibn Walid", "Amr ibn Al-As", "Talalha"],
            correta: 1,
            explicacao: "Khalid ibn Al-Walid, em seu leito de morte, chorou e disse: 'Morri em uma cama quando teria preferido morrer como mártir.' (Tabari)"
        },
        {
            pergunta: "A qual companheiro o Profeta ﷺ disse: \"Se eu tivesse uma terceira filha para casar, eu a teria dado a você como esposa\"?",
            opcoes: ["Abu Bakr", "Omar", "Ali", "Otman"],
            correta: 3,
            explicacao: "Othman casou-se com duas filhas do Profeta ﷺ, Ruqiyyah e Umm Kulthum, após a morte de cada uma."
        },
        {
            pergunta: "Quem foi o companheiro que serviu de escriba ao Profeta ﷺ e desempenhou um papel fundamental na redação do Alcorão?",
            opcoes: ["Abu Hurayra (R.A)", "Zayd ibn Thabit", "Ibn Abbas", "Ubayy ibn Ka'b"],
            correta: 1,
            explicacao: "Zayd ibn Thabit disse: \"Eu costumava anotar a revelação para o Mensageiro de Allah (que a paz e as bênçãos estejam sobre ele).\" (Sahih Al-Bukhari)"
        },
        {
            pergunta: "Quem é a causa da revelação da Surata Abassa?",
            opcoes: ["Abdallah Ibn Ommi Maktum", "Abdallah Ibn Obey Ibn Saloul", "Abdullah Ibn Abbas", "Abdallah Ibn Mas'oud"],
            correta: 0,
            explicacao: "Abdullah Ibn Umm Maktum era cego, mas apesar disso, liderou a chamada para a oração (Adhan)."
        },
        {
            pergunta: "Qual companheiro do Profeta ﷺ era conhecido por sua eloquência e domínio da poesia?",
            opcoes: ["Hassan ibn Thabit", "Abu Ubayda", "Ubayy ibn Ka'b", "Anas Ibn Malik"],
            correta: 0,
            explicacao: "O Profeta ﷺ disse a Hassan ibn Thabit: 'Refute os coraixitas com sua poesia, pois Jibril está com você.' (Sahih Al-Bukhari, 3213)"
        },
        {
            pergunta: "Quantas vezes Omar Ibn Khattab é mencionado no Alcorão?",
            opcoes: ["0", "1", "2", "3"],
            correta: 0,
            explicacao: "O único companheiro mencionado pelo nome no Alcorão é Zayd ibn Haritha, filho adotivo do Profeta ﷺ antes do Islã."
        },
        {
            pergunta: "Qual companheiro era conhecido por sua beleza e elegância antes do Islã e sacrificou tudo pela causa de Alá?",
            opcoes: ["Mus'ab ibn Umayr", "Abu Hurayra", "Ali", "Hamza"],
            correta: 0,
            explicacao: "Mus'ab era o mais elegante dos jovens de Meca antes do Islã, depois renunciou a tudo pelo Islã. (Sahih Muslim, 1924)"
        },
        {
            pergunta: "Qual era o nome da filha de Omar?",
            opcoes: ["Zeyneb", "Fátima", "Hafsa", "Maymouna"],
            correta: 2,
            explicacao: "Hafsa foi esposa do Profeta ﷺ e desempenhou papel importante na preservação do Alcorão compilado pelos companheiros."
        },
        {
            pergunta: "Quem ostenta o apelido de Califa do Profeta ﷺ?",
            opcoes: ["Abu Bakr(R.A)", "Omar(R.A)", "Otman(R.A)", "Ali (R.A)"],
            correta: 0,
            explicacao: "Abu Bakr foi o primeiro califa do Islã e é chamado de Khalifat Ar-Rasul (Califa do Profeta)."
        },
        {
            pergunta: "Qual companheiro se casou com Fátima, a filha do Profeta ﷺ?",
            opcoes: ["Abu Bakr(R.A)", "Omar(R.A)", "Otman(R.A)", "Ali (R.A)"],
            correta: 3,
            explicacao: "Ali ibn Abu Talib se casou com Fátima (R.A), a filha do Profeta ﷺ."
        },
        {
            pergunta: "Qual companheiro o Profeta ﷺ descreveu como \"o mais confiável de sua comunidade\"?",
            opcoes: ["Ubayda Ibn Jarah (R.A)", "Salman El Farisi (R.A)", "Abdullah Ibn Abbas (R.A)", "Abdullah Ibn Omar (R.A)"],
            correta: 0,
            explicacao: "Abu Ubayda Ibn Jarah é um dos 10 prometidos ao Paraíso e foi considerado extremamente confiável pelo Profeta."
        },
        {
            pergunta: "Qual companheiro recebeu o apelido de \"O Tradutor do Alcorão\" devido ao seu vasto conhecimento?",
            opcoes: ["Ibn Abbas", "Abu Hurayra", "Ibn Mas'ud", "Anas ibn Malik"],
            correta: 0,
            explicacao: "O Profeta ﷺ disse: \"Ó Allah, concede-lhe entendimento do Alcorão.\" (Sahih Al-Bukhari, 75) - Referindo-se a Ibn Abbas"
        },
        {
            pergunta: "Encontre o elemento diferente...",
            opcoes: ["Abdullah Ibn Abbas", "Abdallah Ibn Mas'oud", "Abdullah Ibn Omar", "Abdallah Ibn Mubarak"],
            correta: 3,
            explicacao: "Abdullah Ibn Mubarak não é um companheiro - ele foi um Tabii (aquele que conheceu os companheiros)."
        },
        {
            pergunta: "Qual companheiro foi mortalmente ferido por uma flecha e desejou que seu sangue fosse uma prova para Alá?",
            opcoes: ["Hamza", "Zayd ibn Haritha", "Ibn Ma'sud", "Saad ibn Mu'adh"],
            correta: 3,
            explicacao: "Quando Saad ibn Mu'adh foi ferido, ele pediu a Alá que não o deixasse morrer antes de ver o fim dos Banu Qurayza. (Tabari)"
        },
        {
            pergunta: "O chefe da delegação dos primeiros emigrantes para a Abissínia era...?",
            opcoes: ["Osama Ibn Zayd", "Khaled Ibn Walid", "Abdullah Ibn Abbas", "Jafar Ibn Abi Talib"],
            correta: 3,
            explicacao: "Jafar Ibn Abi Talib era irmão de Ali e primo do Profeta ﷺ, e liderou a migração para a Abissínia."
        },
        {
            pergunta: "Qual companheiro foi assassinado enquanto era califa, lendo o Alcorão?",
            opcoes: ["Omar", "Otman", "Ali", "Abu Bakr"],
            correta: 1,
            explicacao: "Ibn Sa'd relata que o sangue de Uthman tocou o versículo: \"Allah vos bastará contra eles. E Ele é o Oniouvinte, o Onisciente.\" (Alcorão, 2:137)"
        }
    ],
    avancado: [
        {
            pergunta: "Por que o califa Omar destituiu o líder dos exércitos muçulmanos, Khalid Ibn Walid, mesmo ele nunca tendo perdido nenhuma batalha?",
            opcoes: ["Por ciúme", "Por ódio", "Por prudência e sabedoria", "Por raiva"],
            correta: 2,
            explicacao: "Omar disse: \"Não demiti Khaled por ele ter feito algo errado, mas sim porque temia que as pessoas o culpassem por todos os nossos sucessos militares.\""
        },
        {
            pergunta: "A quem Abu Bakr pediu para compilar o Alcorão?",
            opcoes: ["Ibn Masoud", "Otman", "Ibn Abbas", "Zayd Ibn Thabit"],
            correta: 3,
            explicacao: "Isso se deveu à morte de muitos camaradas na Batalha de Yamama, a primeira compilação oficial foi feita durante o califado de Abu Bakr."
        },
        {
            pergunta: "Quem foi o poeta que se manifestou em defesa do Profeta ﷺ?",
            opcoes: ["Amr Ibn Al Ass", "Kaab ibn Malik", "Abdullah Ibn Oumi Maktum", "Ibn Abi Quhafa"],
            correta: 1,
            explicacao: "O Profeta ﷺ teve um total de 4 poetas que foram porta-vozes do Islã e que o defenderam, entre eles Kaab Ibn Malik, que Allah esteja satisfeito com ele."
        },
        {
            pergunta: "Al-Hassan, neto do Profeta ﷺ, foi eleito Califa após a morte de seu pai, Ali.",
            opcoes: ["Verdadeiro", "Falso"],
            correta: 0,
            explicacao: "Seu califado durou menos de seis meses; ele cedeu o poder a Muawiya para evitar uma guerra mortal entre muçulmanos."
        },
        {
            pergunta: "Qual das Mães dos Crentes participou da Batalha do Camelo ou Batalha de Basra em 656?",
            opcoes: ["Maymouna", "Safiyya", "Aicha", "Hafsa"],
            correta: 2,
            explicacao: "A Batalha do Camelo, também conhecida como Batalha de Basra, é um evento significativo na história islâmica durante a primeira guerra civil muçulmana."
        },
        {
            pergunta: "Quem foi Ibn Abi Quhafa?",
            opcoes: ["Abu Bakr", "Omar", "Otman", "Ali"],
            correta: 0,
            explicacao: "Abu Quhafa era o pai de Abu Bakr (Abdullah ibn Uthman), primeiro califa do Islã."
        },
        {
            pergunta: "Qual companheiro relatou o maior número de hadiths?",
            opcoes: ["Anas Ibn Malik", "Ibn Omar", "Ali", "Abu Hurayra"],
            correta: 3,
            explicacao: "Abu Hurayra trouxe 5374 hadiths, o maior número entre todos os companheiros."
        },
        {
            pergunta: "Qual companheiro recepcionou o Profeta ﷺ em Medina?",
            opcoes: ["Salman El Farisi", "Saad Ibn Obeida", "Saad Ibn Mo'ad", "Abu Ayub El Ansari"],
            correta: 3,
            explicacao: "Abu Ayub El Ansari o abrigou por 7 meses quando chegou a Medina após a Hégira."
        },
        {
            pergunta: "Quem disse: \"Como vocês podem escravizar homens que nasceram livres?\"",
            opcoes: ["Omar", "Abdullah Ibn Abbas", "Anas Ibn Malik", "Abu Bakr"],
            correta: 0,
            explicacao: "Omar era conhecido por sua defesa da justiça. Libertar um escravo permite que um muçulmano se aproxime de seu Senhor."
        },
        {
            pergunta: "O companheiro conhecido por ter pernas finas era…?",
            opcoes: ["Abdullah Ibn Mas'oud", "Abu Bakr", "Omar", "Zubayr Ibn Awwam"],
            correta: 0,
            explicacao: "O Profeta ﷺ disse sobre Abdullah Ibn Mas'oud: \"Elas certamente pesam mais na balança do que Uhud.\" (Relatado por Ahmad)"
        },
        {
            pergunta: "\"Quem quiser ler o Alcorão como foi revelado deve ir a [...]\"",
            opcoes: ["Abdullah Ibn Abbas", "Abdullah Ibn Omar", "Abdallah Ibn Mas'oud", "Abdallah Ibn Salem"],
            correta: 2,
            explicacao: "Abdullah Ibn Mas'ud era especialista em estudos corânicos e jurisprudência. Ele foi um protegido do Profeta do Islã."
        },
        {
            pergunta: "Qual casa de um companheiro serviu como local de ensino no início do Islã?",
            opcoes: ["Arqam Ibn Arqam", "Abu Tabib", "Saad Ibn Waqas", "Ammar Ibn Yassir"],
            correta: 0,
            explicacao: "A casa de Arqam Ibn Arqam foi um importante centro de aprendizado islâmico nos primeiros dias do Islã."
        },
        {
            pergunta: "Quem era o hipócrita de Medina?",
            opcoes: ["Abdallah Ibn Obey Ibn Saloul", "Abu Jahal", "Abu Sofian", "Huyayy Ibn Akhtab"],
            correta: 0,
            explicacao: "Seu filho, no entanto, era um dos associados próximos do Profeta ﷺ. Seu ódio derivava do fato de que ambicionava ser escolhido como rei de Medina."
        },
        {
            pergunta: "Eu sou a ciência e [...] é a porta de entrada para ela.",
            opcoes: ["Abderahman Ibn Awf", "Talalha", "Omar", "Ali"],
            correta: 3,
            explicacao: "O Profeta ﷺ disse: \"...Quem quiser ir à cidade deve passar pelo portão.\" Referindo-se a Ali como porta de entrada para a sabedoria (Reportado por Al-Hakim)"
        },
        {
            pergunta: "Qual companheiro participou das maiores batalhas e recebeu o apelido de \"O Falcão de Quraysh\"?",
            opcoes: ["Talalha", "Zubayr", "Ali", "Abu Ubayda"],
            correta: 1,
            explicacao: "O Profeta ﷺ disse: \"Zubayr é meu discípulo neste mundo e no Além.\" (Sahih Al-Bukhari, 3719)"
        },
        {
            pergunta: "Qual companheiro transmitiu mais de 1000 hadiths?",
            opcoes: ["Ali", "Abu Bakr", "Abdallah Ibn Masoud", "Anas Ibn Malik"],
            correta: 3,
            explicacao: "Anas Ibn Malik foi um dos seis companheiros que transmitiram mais de 1000 hadiths."
        },
        {
            pergunta: "No versículo: \"Ele era o segundo dos dois quando estavam na caverna e disse ao seu companheiro: Não te aflijas, pois Deus está conosco\" (9:40). A qual companheiro se refere?",
            opcoes: ["Abu Bakr", "Omar", "Otman", "Ali"],
            correta: 0,
            explicacao: "Abu Bakr acompanhou o Profeta ﷺ na caverna durante a Hégira, sendo \"o segundo dos dois\"."
        },
        {
            pergunta: "Qual companheiro recebeu o apelido de \"O Guardião desta comunidade\" do Profeta ﷺ?",
            opcoes: ["Abu Bakr", "Abu Ubayda", "Ibn Abbas", "Otman"],
            correta: 1,
            explicacao: "Toda comunidade tem um guardião, e o guardião desta comunidade é Abu Ubayda. (Sahih Muslim, 2419)"
        }
    ]
};

function comecarNivel(nivel) {
    nivelAtual = nivel;
    perguntas = [...bancoPerguntas[nivel]];
    // Embaralha aleatoriamente as perguntas do nível
    for (let i = perguntas.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [perguntas[i], perguntas[j]] = [perguntas[j], perguntas[i]];
    }
    indiceAtual = 0;
    pontos = 0;

    document.getElementById("tela-niveis").style.display = "none";
    document.getElementById("tela-quiz").style.display = "block";

    document.getElementById("nivel-titulo").textContent = 
        `Nível: ${nivel.charAt(0).toUpperCase() + nivel.slice(1)}`;

    mostrarPergunta();
}

function mostrarPergunta() {
    if (indiceAtual >= perguntas.length) {
        mostrarResultado();
        return;
    }

    const q = perguntas[indiceAtual];
    
    document.getElementById("contador-pergunta").textContent = 
        `Pergunta ${indiceAtual + 1} de ${perguntas.length}`;
    
    document.getElementById("pergunta-texto").textContent = q.pergunta;

    const container = document.getElementById("opcoes-container");
    container.innerHTML = "";

    q.opcoes.forEach((opcao, index) => {
        const btn = document.createElement("button");
        btn.className = "btn-opcao";
        btn.textContent = opcao;
        btn.onclick = () => selecionarResposta(index);
        container.appendChild(btn);
    });

    document.getElementById("btn-proxima").disabled = true;
    document.getElementById("explicacao-box").innerHTML = "";
}

function selecionarResposta(escolha) {
    const q = perguntas[indiceAtual];
    const botoes = Array.from(document.querySelectorAll(".btn-opcao"));

    // Desabilita todas as opções para evitar múltiplos cliques
    botoes.forEach(b => b.disabled = true);

    if (escolha === q.correta) {
        // Acertou: marca a escolhida como correta e esconde as restantes
        botoes[escolha].classList.add("correta");
        pontos++;

        botoes.forEach((b, i) => {
            if (i !== escolha) b.style.display = 'none';
        });
    } else {
        // Errou: marca a escolhida como errada e mostra a correta
        botoes[escolha].classList.add("errada");
        botoes[q.correta].classList.add("correta");

        botoes.forEach((b, i) => {
            if (i !== escolha && i !== q.correta) b.style.display = 'none';
        });
    }

    if (q.explicacao) {
        document.getElementById("explicacao-box").textContent = q.explicacao;
    }

    document.getElementById("btn-proxima").disabled = false;
}

function mostrarProxima() {
    indiceAtual++;
    mostrarPergunta();
}

function mostrarResultado() {
    document.getElementById("tela-quiz").style.display = "none";
    document.getElementById("tela-resultado").style.display = "block";

    const total = perguntas.length;
    const percentual = Math.round((pontos / total) * 100);

    document.getElementById("acertos").textContent = pontos;
    document.getElementById("erros").textContent = total - pontos;
    document.getElementById("percentual-texto").textContent = percentual + "%";
    document.getElementById("percentual-final").textContent = percentual + "%";

    let status = "Precisa melhorar";
    if (percentual >= 80) status = "Excelente! ṣallallāhu ʿalayhi wa sallam";
    else if (percentual >= 60) status = "Muito bom!";
    else if (percentual >= 40) status = "Razoável";

    document.getElementById("status-final").textContent = status;

    animarCirculo(percentual);

    const btnProximo = document.getElementById("btn-proximo-nivel");
    if (percentual >= 80 && nivelAtual !== "avancado") {
        btnProximo.style.display = "inline-block";
        btnProximo.onclick = () => {
            const proximo = nivelAtual === "iniciante" ? "intermediario" : "avancado";
            comecarNivel(proximo);
        };
    }
}

function animarCirculo(percentualFinal) {
    const circulo = document.getElementById("circulo-progresso");
    let atual = 0;
    
    const timer = setInterval(() => {
        atual += 2;
        circulo.style.background = `conic-gradient(var(--accent-color) ${atual * 3.6}deg, var(--secondary-color) 0deg)`;
        
        if (atual >= percentualFinal) {
            clearInterval(timer);
            circulo.style.background = `conic-gradient(var(--accent-color) ${percentualFinal * 3.6}deg, var(--secondary-color) 0deg)`;
        }
    }, 20);
}

function reiniciarNivel() {
    comecarNivel(nivelAtual);
}

// Eventos
document.getElementById("btn-proxima").onclick = mostrarProxima;